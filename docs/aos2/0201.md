---
layout: page-sidenav
group: "Estimating the CDF and Statistical Functionals"
title: "The Empirical Distribution Function"
---

- 실수 $$ \mathbb{R} $$ 위의 분포함수 \\( F \\) 로부터 표본 $$ X_{1}, X_{2},\ldots, X_{n} $$ 을 i.i.d. 로 추출했다고 했을 때, $$ F $$ 를 어떻게 추정할 수 있을까? 우리는 경험적 분포함수(empirical distribution function) 을 사용해서 $$ F $$ 를 추정할 것이다.

---

`Definition 1`. **경험적 분포 함수(empirical distribution function)** $$ \hat{F}_{n} $$ 은 각 $$ X_{i} $$ 에 $$ 1/n $$ 로 mass 가 정의된 확률분포의 CDF 로 정의한다. 보다 엄밀하게 정의하면 다음과 같다 :

$$
\hat{F}_{n}(x) = \frac{1}{n}\sum_{i=1}^{n}\mathbf{1}_{\{X_{i}\leq x\}}(x)
$$

위 정의에서 $$ \mathbf{1}_{A}(x) $$ 은 $$ x\in A $$ 이면 1 이고 $$ x\notin A $$ 이면 0 인 [지시함수(indicator function)](https://en.wikipedia.org/wiki/Indicator_function) 이다 :

$$
\mathbf{1}_{\{X_{i} \leq x \}} = \begin{cases} 1 & : \text{if } X_{i} \leq x \\ 0 & : \text{if } X_{i} > x  \end{cases}
$$

---

![figure1.1]({{ site.baseurl }}/images/aos2_Figure020101.png){:class="center-block" height="200px"}

- 위 그림은 경험적 분포함수(검은색 실선)을 그린 그래프이다
	- 경험적 분포함수는 각 $$ X_{i} $$ 위에 확률질량을 가지는 확률분포의 CDF 이므로 계단모양의 증가함수이다
	- 그림에서 $$ x $$ 축에 수직으로 그려진 각 선은 데이터 $$ X_{i} $$ 를 $$ \frac{1}{n} $$ mass 로 표시한 것이다. 
	- 빨간색 선은 95% 신뢰구간을 나타낸다
	- 경험적 분포함수는 Python 에서 `statsmodels.distributions` 의 `ECDF` 함수로 구현 가능하다

```python
import numpy as np
from ECDF import statsmodels.distributions
X = np.random.normal(size = 1000) 	# 데이터 생성
ecdf = ECDF(X) 				# 데이터 X 로 경험적 분포함수 생성
```

---

`Theorem 1`. 임의의 $$ x \in \mathbb{R} $$ 에 대해 다음이 성립한다 :

$$
\mathbb{E}_{\theta}(\hat{F}_{n}(x)) = F(x)
$$

$$
\mathbb{V}_{\theta}(\hat{F}_{n}(x)) = \frac{F(x)(1-F(x))}{n}
$$

$$
\text{MSE}=\frac{F(x)(1-F(x))}{n}\to 0
$$

$$
\hat{F}_{n}(x) \overset{p}{\longrightarrow} F(x)
$$

[증명](https://sungbinlim.github.io/sl/proof/aos2/020101.pdf)

---

`Theorem 2` (The Glivenko-Cantelli Theorem) : $$ X_{1},\ldots, X_{n}\overset{\text{i.i.d.}}{\sim} F $$ 일 때, 다음이 성립한다

$$
\sup_{x\in\mathbb{R}}|\hat{F}_{n}(x) - F(x)| \overset{\text{a.s.}}{\longrightarrow} 0
$$

---

`Theorem 3` (The Dvoretzky-Kiefer-Wolfowitz (DKW) Inequality) : $$ X_{1},\ldots, X_{n}\overset{\text{i.i.d.}}{\sim} F $$ 일 때, 임의의 $$ \epsilon >0 $$ 에 대해 다음이 성립한다

$$
\mathbb{P}\left( \sup_{x\in\mathbb{R}}|F(x) - \hat{F}_{n}(x)| > \epsilon \right) \leq 2 e^{-2n\epsilon^{2}}\quad\cdots\quad(1)
$$

---

- DKW 부등식에 의해 다음과 같이 신뢰구간을 구할 수 있다

---

`Theorem 3` (A Nonparametric $$ 1-\alpha $$ Confidence Band for $$ F $$) 다음과 같이 $$ L(x) $$ 와 $$ U(x) $$ 를 정의한다 : 


$$
L(x) = \max \{ \hat{F}_{n}(x)-\epsilon_{n}, 0 \}
$$

$$
U(x) = \min \{ \hat{F}_{n}(x) + \epsilon_{n}, 1 \}
$$

$$
\epsilon_{n} = \sqrt{\frac{1}{2n}\log\left(\frac{2}{\alpha}\right)}
$$

이 때, DKW 부등식에 의해 대해 다음이 성립한다 :

$$
\mathbb{P}\Big( L(x) \leq F(x) \leq U(x), \ \forall x\in\mathbb{R} \Big) \geq 1-\alpha\quad\cdots\quad(2)
$$

---

- 부등식 (2) 는 식 (1) 에 $$ \epsilon_{n} $$ 을 대입하는 것으로 쉽게 구할 수 있다

